<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mandelbrot Fractal</title>
</head>
<body>
    <canvas id="canvas" width="800" height="800"></canvas>
    <script type="x-shader/x-fragment" id="fragmentShader">
        precision highp float;

        uniform vec2 resolution;
        uniform vec2 zoom;
        uniform vec2 offset;

        void main() {
            vec2 p = (gl_FragCoord.xy - resolution) / min(resolution.y, resolution.x) * zoom + offset;

            vec2 z = p;
            float i = 0.0;
            for (i = 0.0; i < 256.0; i++) {
                z = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y) + p;
                if (length(z) >= 2.0) break;
            }

            float c = i / 255.0;
            gl_FragColor = vec4(c, c, c, 1.0);
        }
    </script>
    <script type="text/javascript">
        const canvas = document.getElementById("canvas");
        const gl = canvas.getContext("webgl");

        const vertexShaderSource = `
            attribute vec2 position;
            void main(void) {
                gl_Position = vec4(position, 0.0, 1.0);
            }
        `;

        const fragmentShaderSource = document.getElementById("fragmentShader").textContent;

        const vertexShader = gl.createShader(gl.VERTEX_SHADER);
        gl.shaderSource(vertexShader, vertexShaderSource);
        gl.compileShader(vertexShader);

        const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
        gl.shaderSource(fragmentShader, fragmentShaderSource);
        gl.compileShader(fragmentShader);

        const program = gl.createProgram();
        gl.attachShader(program, vertexShader);
        gl.attachShader(program, fragmentShader);
        gl.linkProgram(program);

        gl.useProgram(program);

        const positionAttributeLocation = gl.getAttribLocation(program, "position");
        const resolutionUniformLocation = gl.getUniformLocation(program, "resolution");
        const zoomUniformLocation = gl.getUniformLocation(program, "zoom");
        const offsetUniformLocation = gl.getUniformLocation(program, "offset");

        const positionBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]), gl.STATIC_DRAW);
        gl.enableVertexAttribArray(positionAttributeLocation);
        gl.vertexAttribPointer(positionAttributeLocation, 2, gl.FLOAT, false, 0, 0);

        const zoom = [3.0, 3.0];
        const offset = [-0.7, 0.0];

        function draw() {
            gl.uniform2fv(resolutionUniformLocation, [canvas.width, canvas.height]);
            gl.uniform2fv(zoomUniformLocation, zoom);
            gl.uniform2fv(offsetUniformLocation, offset);

            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
        }

        draw();
    </script>
</body>
</html>
